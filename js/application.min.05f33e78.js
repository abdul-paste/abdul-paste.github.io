!function(e){e.Spectre=function(){let t,n={};return{formatDuration:function(e){return(e|=0)<60?e+"s":e<3600?(e/60|0)+"m"+(e%60|0)+"s":(e/3600|0)+"h"+(e%3600/60|0)+"m"+(e%60|0)+"s"},loadLanguages:async function(){const e=[],o={},a=await fetch("/languages.json",{cache:"no-cache"}).then(e=>e.json());for(const t of a){for(const e of t.languages)o[e.id]=e,e.alt_ids&&e.alt_ids.forEach(t=>{o[t]=e});e.push({label:t.name,choices:t.languages})}n=o,t=e},languagesForSelect2:function(){return t},languageNamed:function(e){if(void 0!==e)return n[e]},defaultLanguage:function(){return this.languageNamed(this.getPreference("defaultLanguage"))},setDefaultLanguage:function(e){this.setPreference("defaultLanguage",e.id)},clearDefaultLanguage:function(){this.clearPreference("defaultLanguage")},defaultExpiration:function(){return this.getPreference("defaultExpiration-md","2d")},setDefaultExpiration:function(e){this.setPreference("defaultExpiration-md",e)},clearDefaultExpiration:function(){this.clearPreference("defaultExpiration-md")},setPreference:function(e,t){localStorage[e]=t},getPreference:function(e,t){return localStorage[e]||t},clearPreference:function(e){delete localStorage[e]},updatePartial:function(e){return fetch(`/partial/${e}`).then(e=>e.text()).then(t=>(document.querySelector(`#partial_container_${e}`).innerHTML=t,t))},shouldRefreshPageOnLogin:function(){return(e.location.pathname.match(/session/)||[]).length>0},refreshPage:function(){e.location.reload()},_loginReplyHandler:async function(e){const t=document.querySelector("#login_error"),n=()=>{animateCSS(t,"fadeOut").then(()=>{t.style.display="none",t.innerHTML=""})};switch(e.status){case"valid":n(),Spectre.shouldRefreshPageOnLogin()?Spectre.refreshPage():(await Spectre.updatePartial("login_logout"),Spectre.displayFlash({type:"success",body:"Successfully logged in."}));break;case"moreinfo":if(n(),void 0!==e.invalid_fields)for(const t of e.invalid_fields){const e=document.querySelector(`form#loginForm input[name="${t}"]`),n=findParentWithClass(e,"control-group");n.style.display="block",animateCSS(n,"fadeIn").then(()=>{e.focus()})}if(void 0!==e.reason){const t=document.querySelector("#login_moreinfo");t.innerHTML=e.reason,t.style.display="block",animateCSS(t,"fadeIn")}break;case"invalid":if(void 0!==e.invalid_fields)for(const t of e.invalid_fields){const e=document.querySelector(`form#loginForm input[name="${t}"]`);findParentWithClass(e,"control-group").classList.add("error")}void 0!==e.reason&&(t.innerHTML=e.reason,t.style.display="block",animateCSS(t,"fadeIn"))}},login:function(e){const t=document.querySelector("#partial_container_login_logout .blocker");t.classList.toggle("hide"),animateCSS(t,"fadeIn");for(const e of document.querySelectorAll("form#loginForm .control-group"))e.classList.remove("error");const n=new FormData;Object.entries(e).forEach(([e,t])=>{n.append(e,String(t))}),fetch("/auth/login",{method:"POST",credentials:"same-origin",body:n}).then(e=>(animateCSS(t,"fadeOut").then(()=>{t.classList.toggle("hide")}),e.json())).then(e=>Spectre._loginReplyHandler(e)).catch(()=>{})},logout:function(){const e=document.querySelector("#partial_container_login_logout .blocker");e.style.display="block",animateCSS(e,"fadeIn"),fetch("/auth/logout",{method:"POST",credentials:"same-origin"}).then(async()=>{animateCSS(e,"fadeOut").then(()=>{e.style.display="none"}),Spectre.shouldRefreshPageOnLogin()?Spectre.refreshPage():(await Spectre.updatePartial("login_logout"),Spectre.displayFlash({type:"success",body:"Successfully logged out."}))}).catch(e=>{alert(e)})},displayFlash:function(e){const t=document.querySelector("#flash-container"),n=t.querySelector("#flash-template").cloneNode(!0);n.removeAttribute("id"),n.querySelector("p").innerHTML=e.body,e.type&&n.classList.add("well-"+e.type),t.appendChild(n),t.style.display="block",setTimeout(()=>{n.style.display="block",animateCSS(n,"fadeIn"),setTimeout(()=>{animateCSS(n,"fadeOut").then(()=>{t.style.display="none",n.remove()})},4e3)},500)}}}()}(window),document.addEventListener("DOMContentLoaded",async()=>{if(docCookies.hasItem("flash")){const e=JSON.parse(atob(docCookies.getItem("flash")));docCookies.removeItem("flash","/"),Spectre.displayFlash(e)}const e=document.querySelector("#code-editor"),t=document.querySelector("#code"),n=document.querySelector("#pasteForm");if(n){const t=n.dataset.context,o=document.getElementById("choices-multiple-groups"),a=new Choices(o,{placeholder:!0,shouldSort:!1}),r=async()=>(await Spectre.loadLanguages(),Spectre.languagesForSelect2());if(a.setChoices(r,"id","name",!0).then(()=>{const e=Spectre.languageNamed(o.dataset.selected)||Spectre.defaultLanguage()||Spectre.languageNamed("text");a.setChoiceByValue(e.id)}),"new"===t){n.querySelector('input[name="expire"]').value=Spectre.defaultExpiration();const e=document.querySelector("#optionsModal"),t=document.querySelector("#optionsButton"),o=new BSN.Modal(e,{keyboard:!0,backdrop:!1});t.addEventListener("click",()=>{o.show()}),Array.from(e.querySelectorAll('input[type="checkbox"]')).forEach(e=>{e.checked="true"===Spectre.getPreference(e.dataset.gbKey,"false"),e.addEventListener("change",e=>{const t=e.target;Spectre.setPreference(t.dataset.gbKey,t.checked?"true":"false")})})}const l=document.querySelector("#deleteModal");if(l){const e=document.querySelector("#deleteModalButton"),t=new BSN.Modal(l,{keyboard:!0,backdrop:!1});e.addEventListener("click",e=>{e.preventDefault(),t.show()})}n.addEventListener("submit",a=>{if((e.value.match(/[^\s]/)||[]).length)"new"===t&&("true"===Spectre.getPreference("saveExpiration","false")?Spectre.setDefaultExpiration(n.querySelector('input[name="expire"]').value):Spectre.clearDefaultExpiration(),"true"===Spectre.getPreference("saveLanguage","false")?Spectre.setDefaultLanguage(o.value):Spectre.clearDefaultLanguage()),n.querySelector('input[name="title"]').value=document.querySelector("#editable-paste-title").innerText;else{a.preventDefault();const e=document.querySelector("#emptyPasteModal");new BSN.Modal(e,{keyboard:!0,backdrop:!1}).show()}}),document.querySelector("#editable-paste-title").addEventListener("keypress",t=>{"Enter"===t.key&&(t.preventDefault(),e.focus())})}const o=document.querySelector("#paste-controls");o&&onMediaQueryChanged("screen and (max-width: 767px)",e=>{if(e.matches){document.querySelector("#phone-paste-control-container").prepend(o)}else{document.querySelector("#desktop-paste-control-container").prepend(o)}}),function(){const e=document.querySelector("#encryptModal"),t=document.querySelector("#encryptionButton");if(!e||!t)return;const o=new BSN.Modal(e,{keyboard:!0,backdrop:!1}),a=e.querySelector('input[type="password"]'),r=n.querySelector('input[name="password"]');o.hide(),e.addEventListener("show.bs.modal",()=>{a.value=r.value}),e.addEventListener("shown.bs.modal",()=>{a.focus(),a.select()});e.addEventListener("hidden.bs.modal",()=>{r.value=a.value,(e=>{const t=document.querySelector("#encryptionIcon");t.classList.remove("icon-lock","icon-lock-open-alt"),t.classList.add(e?"icon-lock":"icon-lock-open-alt"),document.querySelector("#encryptionButton .button-data-label").innerText=e?"On":""})(a.value.length>0)}),a.addEventListener("keypress",e=>{"Enter"===e.key&&o.hide()}),t.addEventListener("click",()=>{o.show()})}(),function(){const e=document.querySelector("#expireModal"),t=document.querySelector("#expirationButton");if(!e||!t)return;const o=new BSN.Modal(e,{keyboard:!0,backdrop:!1});o.hide();const a=n.querySelector('input[name="expire"]'),r=document.querySelector("#expirationButton .button-data-label"),l=e=>{e.classList.add("active"),e.firstChild.checked=!0,a.value=e.dataset.value,r.innerHTML=e.dataset.displayValue},c=document.querySelector("#expireButtonGroup");new BSN.Button(c),c.addEventListener("change.bs.button",t=>{l(e.querySelector("label[data-value].active")),o.hide()}),l(e.querySelector(`label[data-value="${a.value}"]`)),t.addEventListener("click",()=>{o.show()})}();const a=document.querySelector("#line-numbers");!function(){if(a)if(t){const e=document.createElement("div");e.style.display="none",e.classList.add("line-highlight-bar","test");const r=e.cloneNode();function n(e,n){e.style.left=`${a.offsetWidth}px`,e.style.top=`${n.offsetTop+n.parentElement.offsetTop}px`,e.style.width=`${t.offsetWidth}px`,e.style.display="block"}function o(e){if(!e)return history.replaceState(null,"","#"),void delete r.dataset.curLine;r.dataset.curLine=e,history.replaceState({line:e},"",`#L${e}`)}r.classList.add("line-highlight-bar-permanent"),document.body.append(e,r);const l=(t.innerText.match(/\n/g)||[]).length+1;fillWithLineNumbers(a,l).then(()=>{for(const t of a.children)t.addEventListener("mouseenter",t=>{n(e,t.target)}),t.addEventListener("mouseleave",()=>{e.style.display="none"}),t.addEventListener("click",e=>{const t=e.target,a=t.innerText;if(r.dataset.curLine===a)return o(void 0),void(r.style.display="none");o(a),n(r,t)});["load","popstate"].forEach(e=>{window.addEventListener(e,()=>{const e=function(e){if(!e)return null;const t=e.match(/^#L(\d+)/);return t?t[1]:null}(window.location.hash);if(!e)return;const t=a.querySelector(`span:nth-child(${e})`);t&&(o(e),n(r,t),setTimeout(()=>{scrollMinimal(t)},250))})})}),window.addEventListener("resize",()=>{e.style.width=`${t.offsetWidth}px`,r.style.width=`${t.offsetWidth}px`}),document.addEventListener("media-query-changed",e=>{if(!r.dataset.curLine)return;const t=a.querySelector(`span:nth-child(${r.dataset.curLine})`);t&&n(r,t)})}else if(e){["input","propertychange"].forEach(t=>{e.addEventListener(t,()=>{const t=(e.value.match(/\n/g)||[]).length+1;fillWithLineNumbers(a,t).then(()=>{document.querySelector(".textarea-height-wrapper").style.left=`${a.offsetWidth}px`}).catch(()=>{})})});const t=new CustomEvent("input");e.dispatchEvent(t),document.addEventListener("media-query-changed",()=>{e.dispatchEvent(t)})}}(),function(){if(!e)return;e.addEventListener("keydown",e=>{if(e.ctrlKey&&!e.altKey&&!e.shiftKey&&"s"===e.key)return e.cancelBubble=!0,e.preventDefault(),void n.requestSubmit();"tab"!==e.key.toLowerCase()||e.ctrlKey||e.altKey||e.shiftKey||(e.cancelBubble=!0,e.preventDefault())});let t=!1;listenForEvents(["input","propertychange"],e,()=>{t=Boolean(e.value)}),n.addEventListener("submit",()=>{t=!1});const o=document.querySelector('[name="deleteForm"]');o&&o.addEventListener("submit",()=>{t=!1}),window.onbeforeunload=(()=>t?"If you leave now, your paste will not be saved.":void 0)}();const r=document.querySelector("[autofocus]:not(:focus)");r&&r.focus();const l=document.querySelectorAll("[title]:not([data-disable-tooltip])");Array.from(l).map(e=>new BSN.Tooltip(e,{placement:"bottom",animation:"fade",container:"body",delay:50}));var c=Math.floor((new Date).getTime()/1e3);const i=document.querySelector("#expirationIcon");i&&(new BSN.Tooltip(i,{placement:"bottom",animation:"fade",container:"body",delay:50}),i.addEventListener("show.bs.tooltip",e=>{const t=e.target,n=Number(t.dataset.reftime),o=Math.floor((new Date).getTime()/1e3),a=c-n,r=Number(t.dataset.value)+a-o;if(r>0)t.dataset.title="Expires in "+Spectre.formatDuration(r);else{const e=Math.random();t.dataset.title=e<=.5?"Wha-! It's going to explode! Get out while you still can!":"He's dead, Jim."}},!1))});